% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ast.R
\name{apply_ast_smoothing}
\alias{apply_ast_smoothing}
\title{Apply AST smoothing to residuals}
\usage{
apply_ast_smoothing(
  resid_df,
  space_mat,
  time_mat,
  age_mat,
  n_age,
  min_year,
  max_year,
  weight_coverage = 0.9
)
}
\arguments{
\item{resid_df}{Data frame with columns: age, year, location, residual,
and optionally coverage.}

\item{space_mat}{Spatial weight matrix.}

\item{time_mat}{Temporal weight matrix.}

\item{age_mat}{Age weight matrix.}

\item{n_age}{Number of age groups.}

\item{min_year}{Start year.}

\item{max_year}{End year.}

\item{weight_coverage}{Coverage weight parameter (default 0.9).}
}
\value{
Data frame with columns: year, age, location, residual_AST.
}
\description{
Core algorithm: combines spatial, temporal, and age weight matrices via
Kronecker products, applies coverage weighting, normalizes, and computes
weighted average of residuals for each prediction cell.
}
\keyword{internal}
