% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ast.R
\name{dmft_ast}
\alias{dmft_ast}
\title{Apply AST (Age-Spatial-Temporal) smoothing to model residuals}
\usage{
dmft_ast(fit, adjacency, config, dentition = c("deciduous", "permanent"))
}
\arguments{
\item{fit}{A fitted lme4 model from \code{\link[=dmft_fit]{dmft_fit()}}.}

\item{adjacency}{Adjacency object from \code{\link[=dmft_adjacency]{dmft_adjacency()}}.}

\item{config}{A \link{dmft_config} object.}

\item{dentition}{\code{"deciduous"} or \code{"permanent"}.}
}
\value{
A list with elements:
\describe{
\item{estimates}{Tibble with columns: region, year, age_group, predicted, residual_ast.}
\item{space_matrix}{Spatial weight matrix.}
\item{time_matrix}{Temporal weight matrix.}
\item{age_matrix}{Age weight matrix.}
}
}
\description{
Implements the AST kernel-smoothing algorithm following Foreman et al. (2012)
and the CRAN AST package methodology. Residuals from a mixed-effects model
are smoothed across three dimensions (space, time, age) using kernel weights,
then added back to predictions.
}
